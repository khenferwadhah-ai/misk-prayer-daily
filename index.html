<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>لوحة مواقيت الصلاة</title>

<style>
/* تضمين الخط مباشرة */
@font-face {
    font-family: 'KafGulzarMoBold';
    src: url('KafGulzarMo-Bold.ttf') format('truetype');
    font-weight: bold;
}

*{margin:0;padding:0;box-sizing:border-box;font-family:'Tahoma',Arial;}
body{
  height:100vh;
  display:flex;
  justify-content:center;
  align-items:center;
  background:url("background.jpg") no-repeat center center fixed;
  background-size:cover;
}
.overlay{
  width:95%;
  max-width:420px;
  background:rgba(0,0,0,0.72);
  border-radius:18px;
  padding:15px;
  text-align:center;
  color:white;
}
.logo{width:85px;margin-bottom:6px;}

/* عنوان الجمعية بالخط الجديد أبيض ثلاثي الأبعاد */
.title {
  font-family: 'KafGulzarMoBold', sans-serif;
  color: #ffffff;
  font-weight: bold;
  text-shadow: 
    2px 2px 4px #000000,
    0 0 6px #ffffff,
    0 0 12px #ffffff;
  margin: 6px 0;
}

/* التاريخ الميلادي والهجري */
.date{
  font-family:'Amiri', serif;
  color:#bfff00;
  font-weight:bold;
  text-shadow: 2px 2px 4px #006600,0 0 8px #bfff00,0 0 15px #80ff00;
  margin:3px 0;
}

/* الساعة الحالية */
.clock{
  font-size:48px;
  font-weight:bold;
  margin:10px 0;
  padding:10px 20px;
  border-radius:12px;
  background:rgba(0,255,0,0.15);
  border:2px solid rgba(0,255,0,0.4);
  box-shadow: 0 0 20px rgba(0,255,0,0.6), 0 0 40px rgba(0,255,0,0.3) inset;
  color:#bfff00;
  text-shadow: 0 0 8px #bfff00, 0 0 15px #80ff00;
}

/* جدول الصلوات */
.table{width:100%;font-size:17px;margin-top:10px;}
.row{display:flex;justify-content:space-between;border-bottom:1px solid rgba(255,255,255,.25);padding:6px 0;}
.next-prayer{color:#bfff00;font-weight:bold;text-shadow:0 0 6px rgba(191,255,0,0.6);}

/* العد التنازلي للصلاة القادمة */
#nextPrayerClock{
  font-size:32px;
  margin-top:8px;
  padding:6px 12px;
  border-radius:10px;
  background:rgba(0,255,0,0.08);
  border:1px solid rgba(0,255,0,0.3);
  box-shadow:0 0 10px rgba(0,255,0,0.4);
  color:#ffffff;
  text-shadow:2px 2px 4px #000000,0 0 6px #ffffff,0 0 12px #ffffff;
}
.next, #nextPrayerClock{
  font-family:'Amiri', serif;
  color:#ffffff;
  font-weight:bold;
  text-shadow:2px 2px 4px #000000,0 0 6px #ffffff,0 0 12px #ffffff;
}
</style>
</head>

<body>

<div class="overlay">

<img src="logo.png" class="logo">

<div class="title">الجمعية الخيرية مسك الختام – القرارم قوقة</div>

<div class="date" id="gregorian">--</div>
<div class="date" id="hijri">--</div>

<div class="clock" id="clock">00:00:00</div>

<div class="next" id="countdownText">الصلاة القادمة: --</div>
<div class="clock" id="nextPrayerClock">--:--:--</div>

<div class="table" id="prayerTable">
  <!-- جدول المواقيت سيتم ملؤه من times.json -->
</div>

<!-- صوت الأذان -->
<audio id="adhanAudio">
  <source src="adhan.mp3" type="audio/mpeg">
</audio>

</div>

<script>
// مثال على مواقيت الصلاة
const prayers = [
  {name:"الفجر", time:"05:40"},
  {name:"الشروق", time:"07:10"},
  {name:"الظهر", time:"12:35"},
  {name:"العصر", time:"15:25"},
  {name:"المغرب", time:"17:55"},
  {name:"العشاء", time:"19:20"}
];

// ملء جدول الصلوات
const container = document.getElementById("prayerTable");
prayers.forEach(p => {
  const div = document.createElement("div");
  div.className = "row";
  div.innerHTML = `<span>${p.name}</span><span>${p.time}</span>`;
  container.appendChild(div);
});

// تحديث الساعة والتواريخ
function updateClockAndDates(){
  const now = new Date();

  document.getElementById("clock").innerText = now.toLocaleTimeString("ar-DZ",{hour12:false});
  document.getElementById("gregorian").innerText = now.toLocaleDateString("ar-DZ",{
    weekday:"long", year:"numeric", month:"long", day:"numeric"
  });

  const cutoff = new Date("2026-02-01T00:00:00");
  let hijriDate = (now < cutoff) ? "12 شعبان 1447" :
      now.toLocaleDateString('ar-SA-u-ca-islamic',{day:'numeric', month:'long', year:'numeric'});
  document.getElementById("hijri").innerText = hijriDate;
}
setInterval(updateClockAndDates,1000);
updateClockAndDates();

// العد التنازلي + تلوين الصلاة القادمة + صوت الأذان
function updateNextPrayerCountdown() {
  const rows = document.querySelectorAll(".row");
  const now = new Date();
  let targetTime = null;
  let nextPrayerName = "";
  let nextRow = null;

  rows.forEach(r => r.classList.remove("next-prayer"));

  for (let row of rows) {
    const name = row.children[0].innerText.trim();
    const time = row.children[1].innerText.trim();
    const [h, m] = time.split(":").map(Number);
    const total = h*60 + m;
    const currentMinutes = now.getHours()*60 + now.getMinutes();
    if (total > currentMinutes) {
      targetTime = new Date();
      targetTime.setHours(h, m, 0, 0);
      nextPrayerName = name;
      nextRow = row;
      row.classList.add("next-prayer");
      break;
    }
  }

  if (!targetTime) {
    for (let row of rows) {
      const name = row.children[0].innerText.trim();
      if (name === "الإمساك") continue;
      const time = row.children[1].innerText.trim();
      const [h, m] = time.split(":").map(Number);
      targetTime = new Date();
      targetTime.setDate(targetTime.getDate() + 1);
      targetTime.setHours(h, m, 0, 0);
      nextPrayerName = name;
      nextRow = row;
      row.classList.add("next-prayer");
      break;
    }
  }

  const diff = Math.max(0, targetTime - now);
  const hrs = String(Math.floor(diff / 3600000)).padStart(2,"0");
  const mins = String(Math.floor((diff % 3600000) / 60000)).padStart(2,"0");
  const secs = String(Math.floor((diff % 60000) / 1000)).padStart(2,"0");

  document.getElementById("nextPrayerClock").innerText =
    hrs + ":" + mins + ":" + secs;
  document.getElementById("countdownText").innerText =
    "الصلاة القادمة: " + nextPrayerName;

  // تشغيل صوت الأذان عند الوصول
  if(diff < 1000){
    const audio = document.getElementById("adhanAudio");
    audio.play().catch(e=>console.log("تشغيل الصوت محجوب في المتصفح:", e));
  }
}
setInterval(updateNextPrayerCountdown,1000);
updateNextPrayerCountdown();

</script>
</body>
</html>